# Push Notification Test App

This repository contains an example implementation of a push notification test app using the Ionic framework with Capacitor. The app demonstrates user registration, login, profile management, and sending push notifications to specific users.

## Table of Contents

- [Push Notification Test App](#push-notification-test-app)
  - [Table of Contents](#table-of-contents)
  - [Features](#features)
  - [Requirements](#requirements)
  - [Getting Started](#getting-started)
    - [Prerequisites](#prerequisites)
    - [Installation](#installation)
  - [Project Structure](#project-structure)
  - [Configuration](#configuration)
    - [Capacitor Configuration](#capacitor-configuration)
    - [Firebase Configuration](#firebase-configuration)
  - [Running the App](#running-the-app)
    - [Development](#development)
    - [Android Build](#android-build)
    - [iOS Build](#ios-build)
  - [API Integration](#api-integration)
  - [Troubleshooting](#troubleshooting)

## Features

- User registration with username, email, password, and device token
- User login with email and password
- User profile page displaying user details and associated device tokens
- Send push notifications to specific users
- Integration with a backend API for user authentication and notification handling

## Requirements

- Node.js (v14.x or later)
- NPM (v6.x or later)
- Ionic CLI (v6.x or later)
- Capacitor CLI (v3.x or later)
- Android SDK (for Android build)
- Xcode (for iOS build)

## Getting Started

### Prerequisites

Before you begin, ensure that you have the following installed on your system:

- Node.js: [Download and Install Node.js](https://nodejs.org)
- Ionic CLI: Install globally using npm

```bash
npm install -g @ionic/cli
```

- Capacitor CLI: Install globally using npm

```bash
npm install -g @capacitor/cli
```

### Installation

1. Clone the repository:

```bash
git clone git@github.com:charlpcronje/Push-Notification-Capacitor-Starter.git
```

2. Navigate to the project directory:

```bash
cd push-test
```

3. Install the dependencies:

```bash
npm install
```

4. Add the Android platform:

```bash
npx cap add android
```

5. Add the iOS platform (macOS only):

```bash
npx cap add ios
```

## Project Structure

The project structure is as follows:

```
push-test/
  |- android/
  |- ios/
  |- node_modules/
  |- public/
  |- src/
  |   |- assets/
  |   |- components/
  |   |- router/
  |   |- services/
  |   |- theme/
  |   |- views/
  |   |- App.vue
  |   |- main.ts
  |- .gitignore
  |- capacitor.config.ts
  |- ionic.config.json
  |- package.json
  |- README.md
  |- tsconfig.json
```

- `android/`: Contains the Android project files generated by Capacitor.
- `ios/`: Contains the iOS project files generated by Capacitor.
- `node_modules/`: Contains the project dependencies installed by npm.
- `public/`: Contains the public assets of the app.
- `src/`: Contains the main source code of the app.
  - `assets/`: Contains static assets used in the app.
  - `components/`: Contains reusable Vue components.
  - `router/`: Contains the Vue Router configuration.
  - `services/`: Contains services for authentication and notification handling.
  - `theme/`: Contains the app's theme styles.
  - `views/`: Contains the main views/pages of the app.
  - `App.vue`: The root component of the app.
  - `main.ts`: The entry point of the app.
- `.gitignore`: Specifies files and directories to be ignored by Git.
- `capacitor.config.ts`: Configuration file for Capacitor.
- `ionic.config.json`: Configuration file for Ionic.
- `package.json`: Contains project metadata and dependencies.
- `README.md`: The project readme file.
- `tsconfig.json`: TypeScript configuration file.

## Configuration

### Capacitor Configuration

The `capacitor.config.ts` file contains the configuration for Capacitor. You can modify the app ID, app name, and other settings in this file.

```typescript
import { CapacitorConfig } from '@capacitor/cli';

const config: CapacitorConfig = {
  appId: 'com.fgx.pulsetest',
  appName: 'Push Test',
  webDir: 'dist',
  server: {
    androidScheme: 'https'
  },
  plugins: {
    PushNotifications: {
      presentationOptions: ["badge", "sound", "alert"]
    }
  }
};

export default config;
```

### Firebase Configuration

To enable push notifications, you need to set up a Firebase project and add the Firebase configuration files to your project.

1. Create a new Firebase project in the [Firebase Console](https://console.firebase.google.com).

2. Generate the `google-services.json` file for your Android app and place it in the `android/app` directory.

3. Generate the `GoogleService-Info.plist` file for your iOS app and place it in the `ios/App` directory.

4. Update the `capacitor.config.ts` file with your Firebase project details:

```typescript
import { CapacitorConfig } from '@capacitor/cli';

const config: CapacitorConfig = {
    // ...
    plugins: {
    // ...
    PushNotifications: {
        presentationOptions: ["badge", "sound", "alert"]
    }
    }
};

export default config;
```

## Running the App

### Development

To run the app in development mode, use the following command:

```bash
ionic serve
```

This will start a development server and open the app in your default browser. The app will automatically reload if you make any changes to the source files.

### Android Build

To build the app for Android, follow these steps:

1. Build the web assets:

```bash
ionic build
```

2. Copy the web assets to the Android project:

```bash
npx cap copy
```

3. Open the Android project in Android Studio:

```bash
npx cap open android
```

4. In Android Studio, build and run the app on an Android device or emulator.

### iOS Build

To build the app for iOS (macOS only), follow these steps:

1. Build the web assets:

```bash
ionic build
```

2. Copy the web assets to the iOS project:

```bash
npx cap copy
```

3. Open the iOS project in Xcode:

```bash
npx cap open ios
```

4. In Xcode, build and run the app on an iOS device or simulator.

## API Integration

The app integrates with a backend API for user authentication and notification handling. The API endpoints and their purposes are as follows:

- **Registration** (`/api/user/register`):
  - Method: POST
  - Purpose: Register a new user with username, email, password, and device token.

- **Login** (`/api/user/login`):
  - Method: POST
  - Purpose: Authenticate user credentials and retrieve a JWT token.

- **User Details** (`/api/user/user_details`):
  - Method: GET
  - Purpose: Retrieve user profile information, including associated device tokens.

- **Update Device Token** (`/api/user/update_device_token`):
  - Method: POST
  - Purpose: Update the device token for a user.

- **Send Notification** (`/api/notification/send_notification`):
  - Method: POST
  - Purpose: Send a push notification to a specific user's device.

Make sure to update the API base URL in the `src/services/auth.service.ts` and `src/services/notification.service.ts` files to match your backend API URL.

## Troubleshooting

If you encounter any issues while running or building the app, try the following:

- Ensure that you have the latest versions of Node.js, Ionic CLI, and Capacitor CLI installed.
- Run `npm install` to ensure all dependencies are up to date.
- Check the console for any error messages or stacktraces that may help identify the issue.
- Refer to the [Ionic documentation](https://ionicframework.com/docs) and [Capacitor documentation](https://capacitorjs.com/docs) for additional troubleshooting guidance.

If the issue persists, please create an issue in the repository with a detailed description of the problem and steps to reproduce it. Make sure to include logs, stack traces, and any other output that may help identify the cause.